import{r as l,m as L,S as y,j as e,L as M}from"./app-BS6cv_Wc.js";import{I as g}from"./input-error-CEjlMKIS.js";import{I as $}from"./input-field-CRW8MW3c.js";import{A as O}from"./app-layout-DbgSLFnR.js";import{S as F}from"./slimselect-wN7lXC_P.js";import{u as K,a as w,D as U,c as B,S as G,v as q,b as H,d as J,s as Q,K as W,P as X}from"./SortableItem-lMTJl65Q.js";import{l as Y}from"./lodash-_SYO2LJj.js";import{L as Z}from"./loader-circle-CewO-iXb.js";import"./ReactToastify-DVt3X755.js";import"./clsx-B-dksMZM.js";import"./useDynamicCss-3Y8c1bj2.js";import"./index-CGaQUzSE.js";import"./createLucideIcon-cEInIR7a.js";const he=({pricingPlans:c,planTypes:C})=>{const x=l.useRef(null),[j,_]=l.useState(c.data),[u,r]=l.useState(!1),[v,I]=l.useState(!1),[n,N]=l.useState({id:""}),{data:d,setData:i,processing:o,post:b,errors:m,reset:f}=L({plan:"",description:"",price:"",active:!0}),P=async s=>{s.preventDefault(),n.id?b(route("system.pricing.update",n.id),{onSuccess:()=>{f(),r(!1)}}):b(route("system.pricing.store"),{onSuccess:()=>{f(),r(!1)}})};l.useEffect(()=>{if(x.current){const s=new F({select:x.current,settings:{showSearch:!1,closeOnSelect:!0},events:{afterChange:t=>{const a=t.length>0?parseInt(t[0].value):null;i("plan",a)}}});return()=>{s.destroy()}}},[x.current,u]),l.useEffect(()=>{_([...c.data].sort((s,t)=>s.hierarchy-t.hierarchy))},[c.data]);const k=K(w(X),w(W,{coordinateGetter:Q})),D=s=>{const{active:t,over:a}=s;t.id!==(a==null?void 0:a.id)&&_(h=>{const R=h.findIndex(p=>p.id===t.id),T=h.findIndex(p=>p.id===(a==null?void 0:a.id)),S=J(h,R,T);return A(S),S})},A=Y.throttle(s=>{const t=s.map((a,h)=>({id:a.id,hierarchy:h+1}));y.post(route("system.pricing.reorder"),{plans:t},{preserveScroll:!0})},1e3),E=s=>{confirm("Are you sure you want to delete this plan?")&&y.delete(route("system.pricing.destroy",s.id),{preserveScroll:!0})},z=s=>{i("plan",s.plan_type.id),i("price",s.price),i("description",s.description),i("active",s.active),N(s)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Settings :: Pricing Plans"}),e.jsxs(O,{title:"Pricing Plans",mainTitle:!1,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"main__title",children:[e.jsx("h2",{children:"Pricing Plans"}),e.jsxs("span",{className:"main__title-stat",children:["Total ",j.length]}),e.jsxs("div",{className:"main__title-wrap",children:[e.jsx("button",{type:"button",className:"main__title-link main__title-link--wrap",onClick:s=>{N({}),r(!0)},children:"Add Plan"}),j.length>0&&e.jsx("button",{type:"button",className:"main__title-link main__title-link--wrap",onClick:()=>I(!v),children:"Reorder Plans"})]})]})}),v?e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"catalog catalog--1",children:e.jsx("div",{className:`relative ${o?"opacity-75":""}`,children:e.jsx(U,{sensors:k,collisionDetection:B,onDragEnd:D,children:e.jsx(G,{items:j,strategy:q,children:e.jsx("div",{className:"row mt-4",children:j.map(s=>e.jsx(H,{id:s.id,children:e.jsx("div",{className:"col-12 mb-4",children:e.jsx("div",{className:"card h-100 shadow-sm bg-dark text-white hover-shadow",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",className:"me-2",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-truncate mt-0 mb-0",children:s.plan_type.name||""}),e.jsxs("p",{className:"p-0 m-0",children:["$",s.price]})]})]})})})})})},s.id))})})})})})}):e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"catalog catalog--1",children:e.jsxs("table",{className:"catalog__table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"SN"}),e.jsx("th",{children:"PLAN"}),e.jsx("th",{children:"DURATION"}),e.jsx("th",{children:"PRICE"}),e.jsx("th",{children:"DESCRIPTION"}),e.jsx("th",{children:"STATUS"}),e.jsx("th",{children:"CREATED DATE"}),e.jsx("th",{children:"ACTIONS"})]})}),e.jsx("tbody",{children:c.data.length>0?c.data.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:"catalog__text",children:++t})}),e.jsx("td",{children:e.jsx("div",{className:"catalog__text",children:s.plan_type.name})}),e.jsx("td",{children:e.jsx("div",{className:"catalog__text",children:s.plan_type.duration})}),e.jsx("td",{children:e.jsxs("div",{className:"catalog__text",children:["$",s.price]})}),e.jsx("td",{children:e.jsx("div",{className:"catalog__text",children:s.description??"N/A"})}),e.jsx("td",{children:e.jsx("div",{className:`catalog__text catalog__text--${s.active?"green":"red"}`,children:s.active?"Active":"In-Active"})}),e.jsx("td",{children:e.jsx("div",{className:"catalog__text",children:s.created_at})}),e.jsx("td",{children:e.jsxs("div",{className:"catalog__btns",children:[e.jsx("button",{className:"catalog__btn catalog__btn--edit","data-bs-toggle":"modal","data-bs-target":"#model-pricing-plan",onClick:a=>{z(s),r(!0)},children:e.jsx("i",{className:"ti ti-edit"})}),e.jsx("button",{type:"button",className:"catalog__btn catalog__btn--delete",onClick:a=>E(s),children:e.jsx("i",{className:"ti ti-trash"})})]})})]},s.id.toString())):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center",children:e.jsx("div",{className:"catalog__text text-center",children:"No Records Found!"})})})})]})})})]}),u&&e.jsx("div",{className:"modal fade show",style:{display:"block"},id:"model-hero-slider","aria-labelledby":"model-hero-slider","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsx("div",{className:"modal-content",children:e.jsx("div",{className:"modal__content",children:e.jsxs("form",{onSubmit:P,className:"",children:[e.jsx("p",{className:"modal__title mb-4",children:n.id?`Update ${n.plan_type.name}`:"New Plan"}),e.jsxs("div",{className:"row",children:[!n.id&&e.jsx("div",{className:"col-12 w-100",children:e.jsxs("div",{className:"sign__group",children:[e.jsxs("select",{className:"sign__selectjs",id:"sign__genre",ref:x,children:[e.jsx("option",{children:"Select Plan"}),C.data.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(g,{message:m.plan})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"sign__group",children:[e.jsx($,{name:"price",type:"text",value:d.price,onChange:(s,t)=>i({...d,[s]:t}),placeholder:"Price",error:m.price}),e.jsx(g,{message:m.price})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"sign__group",children:[e.jsx("textarea",{id:"text",name:"text",className:`sign__textarea ${m.description?"is-invalid":""}`,placeholder:"Description",onChange:s=>i("description",s.target.value),value:d.description}),e.jsx(g,{message:m.description})]})}),e.jsxs("div",{className:"sign__group sign__group--checkbox",children:[e.jsx("input",{id:"active",name:"active",type:"checkbox",checked:d.active,onClick:()=>i("active",!d.active)}),e.jsx("label",{htmlFor:"active",children:"Status"})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("button",{type:"button",className:"sign__btn sign__btn--modal me-5",disabled:o,onClick:s=>r(!1),children:"Cancle"}),e.jsxs("button",{type:"submit",className:"sign__btn sign__btn--modal",disabled:o,children:[o&&e.jsx(Z,{className:"h-6 w-4 mr-2 animate-spin"}),o?"Saving...":"Save"]})]})})]})]})})})})})]})]})};export{he as default};
